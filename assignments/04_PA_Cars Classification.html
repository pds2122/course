
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Programming Assignment 4 - Cars Classification &#8212; Practical Data Science 2021/2022</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/unilogo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Practical Data Science 2021/2022</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../README.html">
   Practical Data Science 2021/2022
  </a>
 </li>
</ul>
    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/assignments/04_PA_Cars Classification.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/assignments/04_PA_Cars Classification.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-and-dataset">
   Introduction and Dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-the-dataloaders">
   Creating the Dataloaders
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#train-the-model">
   Train the Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#result-interpretation">
   Result Interpretation
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p><em>Practical Data Science 21/22</em></p>
<div class="tex2jax_ignore mathjax_ignore section" id="programming-assignment-4-cars-classification">
<h1>Programming Assignment 4 - Cars Classification<a class="headerlink" href="#programming-assignment-4-cars-classification" title="Permalink to this headline">¶</a></h1>
<p>In this programming assignment, you will need to apply your new deep learning knowledge on image classification.</p>
<p>First, you need to import all the necessary packages for this assignment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install git+https://github.com/fastai/fastai.git # upgrade fastai on colab
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting git+https://github.com/fastai/fastai.git
  Cloning https://github.com/fastai/fastai.git to /tmp/pip-req-build-9bo404ik
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Running command git clone -q https://github.com/fastai/fastai.git /tmp/pip-req-build-9bo404ik
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>^C
<span class=" -Color -Color-Red">ERROR: Operation cancelled by user</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.vision.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">scipy.io</span> <span class="kn">import</span> <span class="n">loadmat</span> <span class="c1">#this package is used to load matlab files</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="introduction-and-dataset">
<h2>Introduction and Dataset<a class="headerlink" href="#introduction-and-dataset" title="Permalink to this headline">¶</a></h2>
<p>You are provided with the <a class="reference external" href="https://ai.stanford.edu/~jkrause/cars/car_dataset.html">Cars Dataset</a> by <a class="reference external" href="https://www.cv-foundation.org//openaccess/content_iccv_workshops_2013/W19/papers/Krause_3D_Object_Representations_2013_ICCV_paper.pdf">Krause, Jonathan, et al., 2013</a>. The Cars dataset contains 16,185 images of 196 classes of cars. The data is split into 8,144 training images and 8,041 testing images, where each class has been split roughly in a 50-50 split. Classes are typically at the level of Make, Model, Year, e.g. 2012 Tesla Model S or 2012 BMW M3 coupe.</p>
<p><img alt="Example Car" src="https://ai.stanford.edu/~jkrause/cars/car4.jpg" /></p>
<p>To help you get started, you can use the following code block to download and store the data (this may take a while!)</p>
<ul class="simple">
<li><p>You may use the Google Drive <a class="reference external" href="https://colab.research.google.com/notebooks/io.ipynb">Integration</a> for Google Colab to save and quickly access the data.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>wget <span class="s1">&#39;http://ai.stanford.edu/~jkrause/car196/cars_train.tgz&#39;</span>
<span class="o">!</span>wget <span class="s1">&#39;http://ai.stanford.edu/~jkrause/car196/cars_annos.mat&#39;</span>
<span class="o">!</span>tar -xf cars_train.tgz
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--2021-12-02 08:19:04--  http://ai.stanford.edu/~jkrause/car196/cars_train.tgz
Resolving ai.stanford.edu (ai.stanford.edu)... 171.64.68.10
Connecting to ai.stanford.edu (ai.stanford.edu)|171.64.68.10|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 979269282 (934M) [application/x-gzip]
Saving to: &#39;cars_train.tgz&#39;

cars_train.tgz      100%[===================&gt;] 933.90M  12.5MB/s    in 81s     

2021-12-02 08:20:26 (11.5 MB/s) - &#39;cars_train.tgz&#39; saved [979269282/979269282]

--2021-12-02 08:20:26--  http://ai.stanford.edu/~jkrause/car196/cars_annos.mat
Resolving ai.stanford.edu (ai.stanford.edu)... 171.64.68.10
Connecting to ai.stanford.edu (ai.stanford.edu)|171.64.68.10|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 394471 (385K) [text/plain]
Saving to: &#39;cars_annos.mat&#39;

cars_annos.mat      100%[===================&gt;] 385.23K   346KB/s    in 1.1s    

2021-12-02 08:20:28 (346 KB/s) - &#39;cars_annos.mat&#39; saved [394471/394471]

tar: car_ims.tgz: Cannot open: No such file or directory
tar: Error is not recoverable: exiting now
</pre></div>
</div>
</div>
</div>
<p>All images of this data set are now stored in the <code class="docutils literal notranslate"><span class="pre">cars_train</span></code> directory. List the first 10 image files in this directory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;cars_train&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Different data sets are labeled in many different ways. The images of this data set are stored in only one directory with their <code class="docutils literal notranslate"><span class="pre">id</span></code> as file name. The labels are stored in a different file called ‘cars_annos.mat’. You can use the following code block to load this file into a DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create Labels from class names</span>
<span class="n">cars_annos</span> <span class="o">=</span> <span class="n">loadmat</span><span class="p">(</span><span class="s1">&#39;cars_train_annos.mat&#39;</span><span class="p">)</span>
<span class="n">class_names</span> <span class="o">=</span> <span class="n">loadmat</span><span class="p">(</span><span class="s1">&#39;cars_meta.mat&#39;</span><span class="p">)[</span><span class="s1">&#39;class_names&#39;</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">class_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
<span class="n">labels</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span>
<span class="c1"># Create Data Frame from .mat file</span>
<span class="n">frame</span> <span class="o">=</span> <span class="p">[[</span><span class="n">i</span><span class="o">.</span><span class="n">flat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">line</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">cars_annos</span><span class="p">[</span><span class="s1">&#39;annotations&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bbox_x1&#39;</span><span class="p">,</span> <span class="s1">&#39;bbox_y1&#39;</span><span class="p">,</span> <span class="s1">&#39;bbox_x2&#39;</span><span class="p">,</span> <span class="s1">&#39;bbox_y2&#39;</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">,</span><span class="s1">&#39;fname&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;fname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;fname&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bbox_x1</th>
      <th>bbox_y1</th>
      <th>bbox_x2</th>
      <th>bbox_y2</th>
      <th>class</th>
      <th>fname</th>
      <th>labels</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>39</td>
      <td>116</td>
      <td>569</td>
      <td>375</td>
      <td>14</td>
      <td>cars_train/00001.jpg</td>
      <td>Audi TTS Coupe 2012</td>
    </tr>
    <tr>
      <th>1</th>
      <td>39</td>
      <td>52</td>
      <td>233</td>
      <td>150</td>
      <td>14</td>
      <td>cars_train/00017.jpg</td>
      <td>Audi TTS Coupe 2012</td>
    </tr>
    <tr>
      <th>2</th>
      <td>52</td>
      <td>47</td>
      <td>586</td>
      <td>260</td>
      <td>14</td>
      <td>cars_train/00411.jpg</td>
      <td>Audi TTS Coupe 2012</td>
    </tr>
    <tr>
      <th>3</th>
      <td>47</td>
      <td>92</td>
      <td>209</td>
      <td>178</td>
      <td>14</td>
      <td>cars_train/00467.jpg</td>
      <td>Audi TTS Coupe 2012</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7</td>
      <td>51</td>
      <td>253</td>
      <td>156</td>
      <td>14</td>
      <td>cars_train/00888.jpg</td>
      <td>Audi TTS Coupe 2012</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="creating-the-dataloaders">
<h2>Creating the Dataloaders<a class="headerlink" href="#creating-the-dataloaders" title="Permalink to this headline">¶</a></h2>
<p>Use the <a class="reference external" href="https://docs.fast.ai/data.block.html#DataBlock">data block API</a> to load the data using <code class="docutils literal notranslate"><span class="pre">df</span></code></p>
<ol class="simple">
<li><p>Define the blocks</p></li>
<li><p>Define the <code class="docutils literal notranslate"><span class="pre">get_x</span></code>and <code class="docutils literal notranslate"><span class="pre">get_y</span></code> using the <code class="docutils literal notranslate"><span class="pre">ColReader()</span></code> function (see <a class="reference external" href="https://docs.fast.ai/data.transforms#ColReader">docs</a> or <a class="reference external" href="https://docs.fast.ai/tutorial.vision.html#Multi-label-classification---With-the-data-block-API">example</a>)</p></li>
<li><p>Split the images randomly into 85% train and 15% validation set (<a class="reference external" href="https://docs.fast.ai/data.transforms#RandomSplitter">docs</a>, use seed = 42)</p></li>
<li><p>Define suitable <a class="reference external" href="https://docs.fast.ai/vision.augment.html#aug_transforms">transforms</a></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here</span>
<span class="c1"># cars = </span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Create the dataloaders from <code class="docutils literal notranslate"><span class="pre">df</span></code></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here</span>
<span class="c1"># dls = </span>
</pre></div>
</div>
</div>
</div>
<p>Now, use the Dataloaders to display three rows of random pictures from a batch.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here</span>
</pre></div>
</div>
</div>
</div>
<p>How many vehicle classes are in the dataset?</p>
<p><strong>Hint</strong>: use <code class="docutils literal notranslate"><span class="pre">dls.vocab</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="train-the-model">
<h2>Train the Model<a class="headerlink" href="#train-the-model" title="Permalink to this headline">¶</a></h2>
<p>Once the data is ready you can start training a model. Use the <code class="docutils literal notranslate"><span class="pre">cnn_learner</span></code> to create a model with</p>
<ul class="simple">
<li><p>a Resnet34 architecture</p></li>
<li><p>the metrics <em>accuracy</em> and <a class="reference external" href="https://docs.fast.ai/metrics.html#top_k_accuracy"><em>top-5 accuracy</em></a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code here</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, you can train the model. Apply the concepts from the lecture, i.e.,</p>
<ul class="simple">
<li><p>finding the learning rate</p></li>
<li><p>training the last layers</p></li>
<li><p>unfreezing the model</p></li>
<li><p>train all layers (learning rate rule of thumb!)</p></li>
</ul>
<p>Always provide an explanation <strong>why</strong> you chose the number of epochs and the learning rate.</p>
<p>Save the model after each training</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;stage-x&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>so that you can reload the model</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;stage-x&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>if something goes wrong. If you load a model with <em>freezed</em> layers, you need to <em>unfreeze</em> the layers again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code and explanations here</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="result-interpretation">
<h2>Result Interpretation<a class="headerlink" href="#result-interpretation" title="Permalink to this headline">¶</a></h2>
<p>Explain the difference betweeen the metrics <em>accuracy</em> and <em>top_5_accuracy</em>. Why can it be useful to report both metrics?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your answer here</span>
</pre></div>
</div>
</div>
</div>
<p>Use the <a class="reference external" href="https://docs.fast.ai/interpret.html">ClassificationInterpretation</a> to analyze the results in more detail. What are your main findings?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write your code and explanations here</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "pds2122"
        },
        kernelOptions: {
            kernelName: "pds2122",
            path: "./assignments"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'pds2122'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>