Traceback (most recent call last):
  File "/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/nbclient/client.py", line 1112, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/nbclient/util.py", line 74, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/nbclient/util.py", line 53, in just_run
    return loop.run_until_complete(coro)
  File "/media/data/anaconda3/envs/pds2122/lib/python3.9/asyncio/base_events.py", line 642, in run_until_complete
    return future.result()
  File "/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/nbclient/client.py", line 553, in async_execute
    await self.async_execute_cell(
  File "/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/nbclient/client.py", line 857, in async_execute_cell
    self._check_raise_for_error(cell, exec_reply)
  File "/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/nbclient/client.py", line 760, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# Bundle preprocessing and modeling code in a pipeline
complete_pipeline = Pipeline(steps=[
    ('preprocessor', preprocessor),
    ('model', model)
])

# Preprocess the raw training data and fit the model
complete_pipeline.fit(X_train, y_train)

# Preprocess the raw validation data and make predictions
preds = complete_pipeline.predict(X_valid)

# Evaluate the model
score = mean_absolute_error(y_valid, preds)
print("MAE using the complete pipeline: {}".format(score))
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mKeyboardInterrupt[0m                         Traceback (most recent call last)
[0;32m/tmp/ipykernel_768348/4174529535.py[0m in [0;36m<module>[0;34m[0m
[1;32m      6[0m [0;34m[0m[0m
[1;32m      7[0m [0;31m# Preprocess the raw training data and fit the model[0m[0;34m[0m[0;34m[0m[0m
[0;32m----> 8[0;31m [0mcomplete_pipeline[0m[0;34m.[0m[0mfit[0m[0;34m([0m[0mX_train[0m[0;34m,[0m [0my_train[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m      9[0m [0;34m[0m[0m
[1;32m     10[0m [0;31m# Preprocess the raw validation data and make predictions[0m[0;34m[0m[0;34m[0m[0m

[0;32m/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/sklearn/pipeline.py[0m in [0;36mfit[0;34m(self, X, y, **fit_params)[0m
[1;32m    344[0m             [0;32mif[0m [0mself[0m[0;34m.[0m[0m_final_estimator[0m [0;34m!=[0m [0;34m'passthrough'[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    345[0m                 [0mfit_params_last_step[0m [0;34m=[0m [0mfit_params_steps[0m[0;34m[[0m[0mself[0m[0;34m.[0m[0msteps[0m[0;34m[[0m[0;34m-[0m[0;36m1[0m[0;34m][0m[0;34m[[0m[0;36m0[0m[0;34m][0m[0;34m][0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 346[0;31m                 [0mself[0m[0;34m.[0m[0m_final_estimator[0m[0;34m.[0m[0mfit[0m[0;34m([0m[0mXt[0m[0;34m,[0m [0my[0m[0;34m,[0m [0;34m**[0m[0mfit_params_last_step[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    347[0m [0;34m[0m[0m
[1;32m    348[0m         [0;32mreturn[0m [0mself[0m[0;34m[0m[0;34m[0m[0m

[0;32m/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/sklearn/ensemble/_forest.py[0m in [0;36mfit[0;34m(self, X, y, sample_weight)[0m
[1;32m    385[0m             [0;31m# parallel_backend contexts set at a higher level,[0m[0;34m[0m[0;34m[0m[0m
[1;32m    386[0m             [0;31m# since correctness does not rely on using threads.[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 387[0;31m             trees = Parallel(n_jobs=self.n_jobs, verbose=self.verbose,
[0m[1;32m    388[0m                              [0;34m**[0m[0m_joblib_parallel_args[0m[0;34m([0m[0mprefer[0m[0;34m=[0m[0;34m'threads'[0m[0;34m)[0m[0;34m)[0m[0;34m([0m[0;34m[0m[0;34m[0m[0m
[1;32m    389[0m                 delayed(_parallel_build_trees)(

[0;32m/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/joblib/parallel.py[0m in [0;36m__call__[0;34m(self, iterable)[0m
[1;32m   1044[0m                 [0mself[0m[0;34m.[0m[0m_iterating[0m [0;34m=[0m [0mself[0m[0;34m.[0m[0m_original_iterator[0m [0;32mis[0m [0;32mnot[0m [0;32mNone[0m[0;34m[0m[0;34m[0m[0m
[1;32m   1045[0m [0;34m[0m[0m
[0;32m-> 1046[0;31m             [0;32mwhile[0m [0mself[0m[0;34m.[0m[0mdispatch_one_batch[0m[0;34m([0m[0miterator[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m   1047[0m                 [0;32mpass[0m[0;34m[0m[0;34m[0m[0m
[1;32m   1048[0m [0;34m[0m[0m

[0;32m/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/joblib/parallel.py[0m in [0;36mdispatch_one_batch[0;34m(self, iterator)[0m
[1;32m    859[0m                 [0;32mreturn[0m [0;32mFalse[0m[0;34m[0m[0;34m[0m[0m
[1;32m    860[0m             [0;32melse[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 861[0;31m                 [0mself[0m[0;34m.[0m[0m_dispatch[0m[0;34m([0m[0mtasks[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    862[0m                 [0;32mreturn[0m [0;32mTrue[0m[0;34m[0m[0;34m[0m[0m
[1;32m    863[0m [0;34m[0m[0m

[0;32m/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/joblib/parallel.py[0m in [0;36m_dispatch[0;34m(self, batch)[0m
[1;32m    777[0m         [0;32mwith[0m [0mself[0m[0;34m.[0m[0m_lock[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    778[0m             [0mjob_idx[0m [0;34m=[0m [0mlen[0m[0;34m([0m[0mself[0m[0;34m.[0m[0m_jobs[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 779[0;31m             [0mjob[0m [0;34m=[0m [0mself[0m[0;34m.[0m[0m_backend[0m[0;34m.[0m[0mapply_async[0m[0;34m([0m[0mbatch[0m[0;34m,[0m [0mcallback[0m[0;34m=[0m[0mcb[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    780[0m             [0;31m# A job can complete so quickly than its callback is[0m[0;34m[0m[0;34m[0m[0m
[1;32m    781[0m             [0;31m# called before we get here, causing self._jobs to[0m[0;34m[0m[0;34m[0m[0m

[0;32m/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/joblib/_parallel_backends.py[0m in [0;36mapply_async[0;34m(self, func, callback)[0m
[1;32m    206[0m     [0;32mdef[0m [0mapply_async[0m[0;34m([0m[0mself[0m[0;34m,[0m [0mfunc[0m[0;34m,[0m [0mcallback[0m[0;34m=[0m[0;32mNone[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    207[0m         [0;34m"""Schedule a func to be run"""[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 208[0;31m         [0mresult[0m [0;34m=[0m [0mImmediateResult[0m[0;34m([0m[0mfunc[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    209[0m         [0;32mif[0m [0mcallback[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    210[0m             [0mcallback[0m[0;34m([0m[0mresult[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m

[0;32m/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/joblib/_parallel_backends.py[0m in [0;36m__init__[0;34m(self, batch)[0m
[1;32m    570[0m         [0;31m# Don't delay the application, to avoid keeping the input[0m[0;34m[0m[0;34m[0m[0m
[1;32m    571[0m         [0;31m# arguments in memory[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 572[0;31m         [0mself[0m[0;34m.[0m[0mresults[0m [0;34m=[0m [0mbatch[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    573[0m [0;34m[0m[0m
[1;32m    574[0m     [0;32mdef[0m [0mget[0m[0;34m([0m[0mself[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m

[0;32m/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/joblib/parallel.py[0m in [0;36m__call__[0;34m(self)[0m
[1;32m    260[0m         [0;31m# change the default number of processes to -1[0m[0;34m[0m[0;34m[0m[0m
[1;32m    261[0m         [0;32mwith[0m [0mparallel_backend[0m[0;34m([0m[0mself[0m[0;34m.[0m[0m_backend[0m[0;34m,[0m [0mn_jobs[0m[0;34m=[0m[0mself[0m[0;34m.[0m[0m_n_jobs[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 262[0;31m             return [func(*args, **kwargs)
[0m[1;32m    263[0m                     for func, args, kwargs in self.items]
[1;32m    264[0m [0;34m[0m[0m

[0;32m/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/joblib/parallel.py[0m in [0;36m<listcomp>[0;34m(.0)[0m
[1;32m    260[0m         [0;31m# change the default number of processes to -1[0m[0;34m[0m[0;34m[0m[0m
[1;32m    261[0m         [0;32mwith[0m [0mparallel_backend[0m[0;34m([0m[0mself[0m[0;34m.[0m[0m_backend[0m[0;34m,[0m [0mn_jobs[0m[0;34m=[0m[0mself[0m[0;34m.[0m[0m_n_jobs[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 262[0;31m             return [func(*args, **kwargs)
[0m[1;32m    263[0m                     for func, args, kwargs in self.items]
[1;32m    264[0m [0;34m[0m[0m

[0;32m/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/sklearn/utils/fixes.py[0m in [0;36m__call__[0;34m(self, *args, **kwargs)[0m
[1;32m    220[0m     [0;32mdef[0m [0m__call__[0m[0;34m([0m[0mself[0m[0;34m,[0m [0;34m*[0m[0margs[0m[0;34m,[0m [0;34m**[0m[0mkwargs[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    221[0m         [0;32mwith[0m [0mconfig_context[0m[0;34m([0m[0;34m**[0m[0mself[0m[0;34m.[0m[0mconfig[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 222[0;31m             [0;32mreturn[0m [0mself[0m[0;34m.[0m[0mfunction[0m[0;34m([0m[0;34m*[0m[0margs[0m[0;34m,[0m [0;34m**[0m[0mkwargs[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m
[0;32m/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/sklearn/ensemble/_forest.py[0m in [0;36m_parallel_build_trees[0;34m(tree, forest, X, y, sample_weight, tree_idx, n_trees, verbose, class_weight, n_samples_bootstrap)[0m
[1;32m    167[0m                                                         indices=indices)
[1;32m    168[0m [0;34m[0m[0m
[0;32m--> 169[0;31m         [0mtree[0m[0;34m.[0m[0mfit[0m[0;34m([0m[0mX[0m[0;34m,[0m [0my[0m[0;34m,[0m [0msample_weight[0m[0;34m=[0m[0mcurr_sample_weight[0m[0;34m,[0m [0mcheck_input[0m[0;34m=[0m[0;32mFalse[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    170[0m     [0;32melse[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    171[0m         [0mtree[0m[0;34m.[0m[0mfit[0m[0;34m([0m[0mX[0m[0;34m,[0m [0my[0m[0;34m,[0m [0msample_weight[0m[0;34m=[0m[0msample_weight[0m[0;34m,[0m [0mcheck_input[0m[0;34m=[0m[0;32mFalse[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m

[0;32m/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/sklearn/tree/_classes.py[0m in [0;36mfit[0;34m(self, X, y, sample_weight, check_input, X_idx_sorted)[0m
[1;32m   1250[0m         """
[1;32m   1251[0m [0;34m[0m[0m
[0;32m-> 1252[0;31m         super().fit(
[0m[1;32m   1253[0m             [0mX[0m[0;34m,[0m [0my[0m[0;34m,[0m[0;34m[0m[0;34m[0m[0m
[1;32m   1254[0m             [0msample_weight[0m[0;34m=[0m[0msample_weight[0m[0;34m,[0m[0;34m[0m[0;34m[0m[0m

[0;32m/media/data/anaconda3/envs/pds2122/lib/python3.9/site-packages/sklearn/tree/_classes.py[0m in [0;36mfit[0;34m(self, X, y, sample_weight, check_input, X_idx_sorted)[0m
[1;32m    392[0m                                            min_impurity_split)
[1;32m    393[0m [0;34m[0m[0m
[0;32m--> 394[0;31m         [0mbuilder[0m[0;34m.[0m[0mbuild[0m[0;34m([0m[0mself[0m[0;34m.[0m[0mtree_[0m[0;34m,[0m [0mX[0m[0;34m,[0m [0my[0m[0;34m,[0m [0msample_weight[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    395[0m [0;34m[0m[0m
[1;32m    396[0m         [0;32mif[0m [0mself[0m[0;34m.[0m[0mn_outputs_[0m [0;34m==[0m [0;36m1[0m [0;32mand[0m [0mis_classifier[0m[0;34m([0m[0mself[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m

[0;31mKeyboardInterrupt[0m: 
KeyboardInterrupt: 

